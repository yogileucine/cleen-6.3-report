{"uid":"12a554c9c9d80e78","name":"Validate the sample limits of Endotoxin residue verification for direct indirect bop","fullName":"tests.scenarios.multi_production_protocol.protocol.test_multi_production_protocol_microbial_policy_absent.TestMicrobialMultiProductionProtocol#test_validate_microbial_residue_swab_limits_absent_zero_split_inspection","historyId":"cfc5f356b546156b4677914b81db89b0","time":{"start":1733033270670,"stop":1733033279859,"duration":9189},"description":"This test case tests API to Create Protocol for Endotoxin residue verification and validate the sample limits when select based on policy for direct and indirect","descriptionHtml":"<p>This test case tests API to Create Protocol for Endotoxin residue verification and validate the sample limits when select based on policy for direct and indirect</p>\n","status":"failed","statusMessage":"AssertionError: Direct Swab perUnitAreaAndVolume Values 23 with 38 Do Not Match","statusTrace":"self = <test_multi_production_protocol_microbial_policy_absent.TestMicrobialMultiProductionProtocol object at 0x000002A416AB3710>\n\n    @allure.title(\"Validate the sample limits of Endotoxin residue verification for direct indirect bop\")\n    @allure.description(\"This test case tests API to Create Protocol for Endotoxin residue verification and validate \"\n                        \"the sample limits when select based on policy for direct and indirect\")\n    @allure.link(\"https://app.clickup.com/t/86cuv1y8g\")\n    @pytest.mark.formulation  # bop = based on policy\n    @pytest.mark.validate_microbial_residue_swab_limits_absent_zero_split_inspection\n    def test_validate_microbial_residue_swab_limits_absent_zero_split_inspection(self):\n>       protocol = self.test_validate_microbial_endotoxin_residue_swab_sample_limits_absent_zero_split()\n\ntests\\scenarios\\multi_production_protocol\\protocol\\test_multi_production_protocol_microbial_policy_absent.py:1478: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntests\\scenarios\\multi_production_protocol\\protocol\\test_multi_production_protocol_microbial_policy_absent.py:1182: in test_validate_microbial_endotoxin_residue_swab_sample_limits_absent_zero_split\n    data = self.test_microbial_endotoxin_protocol_swab_absent_zero_split()\ntests\\scenarios\\multi_production_protocol\\protocol\\test_multi_production_protocol_microbial_policy_absent.py:752: in test_microbial_endotoxin_protocol_swab_absent_zero_split\n    self.protocol_microbial.compare_microbial_limits_split(updated_data, *method, \"swab\")\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <unit.protocols.protocol_microbial_residue_verification.ProtocolMicrobialAcceptanceCriteria object at 0x000002A416A55DD0>\ndata = {'direct': {'bacterial': {'equipments': {'101': {'enabled': True, 'perUnitArea': {'unit': 'sqcm', 'value': 3}, 'perUni...', 'value': 28}, 'perUnitVolume': {'unit': 'ml', 'value': 23}, 'rinseLimit': 36, ...}, ...}, 'policy': 'policyBased'}}}\nresponse_type = 'direct', microbial_type = 'fungal', method_type = 'Swab', surface_unit = 'sqcm', volume_unit = 'ml'\n\n    def compare_microbial_limits_split(self, data, response_type, microbial_type, method_type=\"swab\",\n                                       surface_unit=\"sqcm\", volume_unit=\"ml\"):\n        microbial_policy = self.policy_microbial.test_get_microbial_cleaning_limits_policy()[\"response\"]\n        policy_data = json.loads(microbial_policy)\n    \n        first_response = self.extract_values(policy_data, response_type)\n        second_response = self.get_limits(data, response_type, microbial_type)\n    \n        # Extract microbial values from the first response\n        if method_type == \"swab\":\n            method_type = \"Swab\"\n            method_limit = \"swab_limit\"\n        else:\n            method_type = \"Rinse\"\n            method_limit = \"rinse_limit\"\n    \n        swab_response = first_response.get(f'{response_type.capitalize()} - {method_type}', {})\n        microbial_swab_first_response = self.extract_microbial_values(swab_response, microbial_type)\n        per_unit_area_and_volume_first_response = None\n        if microbial_type == \"fungal\":\n            per_unit_area_and_volume_first_response = swab_response.get('unclassified', {}).get(\n                'fungal_per_unit_volume')\n    \n        if microbial_type == \"bacterial\":\n            per_unit_area_and_volume_first_response = swab_response.get('unclassified', {}).get(\n                'bacterial_per_unit_volume')\n    \n        # Extract microbial values from the second response more explicitly\n        second_response_key = list(second_response.keys())[0] if second_response else None\n        microbial_swab_second_response = second_response.get(second_response_key, {}).get(method_limit, {}).get('value')\n        per_unit_area_and_volume_second_response = (\n            second_response.get(second_response_key, {}).get(method_limit, {}).get('perUnitArea', {}).get('value'))\n    \n        if surface_unit == \"sqm\":\n            per_unit_area_and_volume_second_response = per_unit_area_and_volume_second_response * 0.0001\n        if surface_unit == \"sqin\":\n            per_unit_area_and_volume_second_response = per_unit_area_and_volume_second_response * 0.155\n        if volume_unit == \"l\":\n            per_unit_area_and_volume_second_response = per_unit_area_and_volume_second_response * 0.001\n    \n        # Compare values with assert statements\n        if microbial_swab_first_response is not None and microbial_swab_second_response is not None:\n            assert round(microbial_swab_first_response, 3) == round(microbial_swab_second_response, 3), \\\n                (f\"{response_type.capitalize()} {method_type} {microbial_type.capitalize()} \"\n                 f\"Values {round(microbial_swab_first_response, 3)} with {round(microbial_swab_second_response, 3)}\"\n                 f\"Do Not Match\")\n        if per_unit_area_and_volume_first_response is not None and per_unit_area_and_volume_second_response is not None:\n>           assert round(per_unit_area_and_volume_first_response, 3) == round(per_unit_area_and_volume_second_response,\n                                                                              3), \\\n                (f\"{response_type.capitalize()} {method_type} perUnitAreaAndVolume \"\n                 f\"Values {round(per_unit_area_and_volume_first_response, 3)} with \"\n                 f\"{round(per_unit_area_and_volume_second_response,3)} \"\n                 f\"Do Not Match\")\nE           AssertionError: Direct Swab perUnitAreaAndVolume Values 23 with 38 Do Not Match\n\ntests\\unit\\protocols\\protocol_microbial_residue_verification.py:394: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"login","time":{"start":1733033270109,"stop":1733033270472,"duration":363},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"get_facility","time":{"start":1733033270472,"stop":1733033270668,"duration":196},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"tag","value":"validate_microbial_residue_swab_limits_absent_zero_split_inspection"},{"name":"tag","value":"formulation"},{"name":"tag","value":"microbial_multi_production_protocol"},{"name":"tag","value":"scenario"},{"name":"parentSuite","value":"tests.scenarios.multi_production_protocol.protocol"},{"name":"suite","value":"test_multi_production_protocol_microbial_policy_absent"},{"name":"subSuite","value":"TestMicrobialMultiProductionProtocol"},{"name":"host","value":"DESKTOP-ESU2KLG"},{"name":"thread","value":"6284-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.scenarios.multi_production_protocol.protocol.test_multi_production_protocol_microbial_policy_absent"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[{"name":"https://app.clickup.com/t/86cuv1y8g","url":"https://app.clickup.com/t/86cuv1y8g","type":"link"}],"hidden":true,"retry":true,"extra":{"categories":[],"tags":["validate_microbial_residue_swab_limits_absent_zero_split_inspection","scenario","formulation","microbial_multi_production_protocol"]},"source":"12a554c9c9d80e78.json","parameterValues":[]}